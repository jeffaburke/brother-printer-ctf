# Apache Virtual Host Configuration for Brother Printer CTF Portal
# Place this file in /etc/apache2/sites-available/brother-printer-ctf.conf

<VirtualHost *:80>
    ServerName _default_
    ServerAlias *
    
    # Application directory
    DocumentRoot /var/www/brother-printer-ctf
    
    # WSGI Configuration
    WSGIDaemonProcess brother-printer-ctf python-home=/var/www/brother-printer-ctf/venv python-path=/var/www/brother-printer-ctf
    WSGIProcessGroup brother-printer-ctf
    WSGIScriptAlias / /var/www/brother-printer-ctf/brother-printer-ctf.wsgi
    
    <Directory /var/www/brother-printer-ctf>
        WSGIApplicationGroup %{GLOBAL}
        Require all granted
    </Directory>
    
    # Static files
    Alias /static /var/www/brother-printer-ctf/static
    <Directory /var/www/brother-printer-ctf/static>
        Require all granted
    </Directory>
    
    # Security headers
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Logging
    ErrorLog ${APACHE_LOG_DIR}/brother-printer-ctf_error.log
    CustomLog ${APACHE_LOG_DIR}/brother-printer-ctf_access.log combined
    
    # Log level for debugging (change to warn for production)
    LogLevel info
</VirtualHost>

# Optional: HTTPS configuration (uncomment and configure if needed)
# <VirtualHost *:443>
#     ServerName printer.local
#     ServerAlias brother-printer.local
#     
#     # SSL Configuration
#     SSLEngine on
#     SSLCertificateFile /path/to/certificate.crt
#     SSLCertificateKeyFile /path/to/private.key
#     
#     # Same configuration as HTTP virtual host
#     WSGIDaemonProcess brother-printer-ctf python-home=/var/www/brother-printer-ctf/venv python-path=/var/www/brother-printer-ctf
#     WSGIProcessGroup brother-printer-ctf
#     WSGIScriptAlias / /var/www/brother-printer-ctf/brother-printer-ctf.wsgi
#     
#     <Directory /var/www/brother-printer-ctf>
#         WSGIApplicationGroup %{GLOBAL}
#         Require all granted
#     </Directory>
#     
#     Alias /static /var/www/brother-printer-ctf/static
#     <Directory /var/www/brother-printer-ctf/static>
#         Require all granted
#     </Directory>
#     
#     # Enhanced security headers for HTTPS
#     Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
#     Header always set X-Content-Type-Options nosniff
#     Header always set X-Frame-Options DENY
#     Header always set X-XSS-Protection "1; mode=block"
#     
#     ErrorLog ${APACHE_LOG_DIR}/brother-printer-ctf_ssl_error.log
#     CustomLog ${APACHE_LOG_DIR}/brother-printer-ctf_ssl_access.log combined
# </VirtualHost>
